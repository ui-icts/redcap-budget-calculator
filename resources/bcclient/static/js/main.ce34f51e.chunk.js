(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{54:function(e,t,a){e.exports=a.p+"static/media/logo.90c7de32.png"},59:function(e,t,a){e.exports=a(83)},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),l=a(15),c=a.n(l),r=(a(64),a(4)),s=a(5),o=a(7),u=a(6),d=a(8),m=(a(65),a(66),a(54)),h=a.n(m),b=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{id:"wrapper"},i.a.createElement("div",{id:"title"},i.a.createElement("h1",null,"Budget Calculator (PROTOTYPE)"),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("div",{id:"budgetTitleDisplay",style:{display:"none"}},i.a.createElement("h5",null,"Title: ",i.a.createElement("span",{id:"budgetTitleText"})),i.a.createElement("small",null,"Last saved ",i.a.createElement("span",{id:"lastSaveTime"})))),i.a.createElement("img",{id:"logo",src:h.a,alt:"Center for Clinical & Translational Science"}),i.a.createElement("div",{style:{clear:"both"}}))}}]),t}(n.Component),f=a(12),p=a(13),v=a(10),C=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.setState({validated:!0}),a.infoForm.checkValidity()&&a.state.infoCallback({subjectCount:a.subjectCount.current.value,visitCount:a.visitCount.current.value})},a.handleCancel=function(e){e.preventDefault(),a.state.hideInfoCallback()},a.state={infoCallback:e.infoCallback,hideInfoCallback:e.hideInfoCallback,subjectCountInvalid:"false",visitCountInvalid:"false",validated:!1},a.subjectCount=i.a.createRef(),a.visitCount=i.a.createRef(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){try{this.subjectCount.current.value=this.props.showInfoSubjectCount,this.visitCount.current.value=this.props.showInfoVisitCount}catch(e){}}},{key:"render",value:function(){var e=this;return i.a.createElement(f.a,{show:this.props.showInfo,id:"budgetInfoModal",centered:!0,backdrop:"static",role:"dialog","aria-labelledby":"budgetInfoModal","aria-hidden":"true"},i.a.createElement(v.a,{ref:function(t){return e.infoForm=t},onSubmit:this.handleConfirm,validated:this.state.validated},i.a.createElement(f.a.Body,null,i.a.createElement("p",null,"Before adding clinical services, please supply this additional information:"),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,null,i.a.createElement(v.a.Label,{htmlFor:"subject_count"},i.a.createElement("b",null,"Subject Count:")),i.a.createElement(v.a.Control,{type:"number",id:"subject_count",name:"subject_count",min:"1",step:"1",ref:this.subjectCount,className:"info-field",required:!0}),i.a.createElement(v.a.Control.Feedback,{type:"invalid"},"This field is required."))),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,null,i.a.createElement(v.a.Label,{htmlFor:"visit_count_default"},i.a.createElement("b",null,"Visit Count:")),i.a.createElement(v.a.Control,{type:"text",pattern:"\\d+",id:"visit_count_default",name:"visit_count_default",ref:this.visitCount,className:"info-field",required:!0}),i.a.createElement(v.a.Control.Feedback,{type:"invalid"},"This field is required."))),i.a.createElement("input",{type:"hidden",name:"redcap_csrf_token",value:""})),i.a.createElement(f.a.Footer,null,i.a.createElement(p.a,{variant:"secondary",onClick:this.handleCancel},"Cancel"),i.a.createElement(p.a,{variant:"primary",type:"submit",onClick:this.handleSubmit},"Confirm"))))}}]),t}(n.Component),S=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.setState({validated:!0}),a.saveForm.checkValidity()&&(a.state.submitSaveCallback({budgetTitle:a.budgetTitle.current.value}),a.setState({showWelcome:!1}),a.state.handleHideSave())},a.handleClose=function(e){try{e.preventDefault()}catch(e){}a.state.handleHideSave()},a.state={showSaveSuccess:e.showSaveSuccess,submitSaveCallback:e.submitSaveCallback,handleHideSave:e.handleHideSave,validated:!1},a.budgetTitle=i.a.createRef(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(f.a,{id:"saveModal",centered:!0,show:this.props.showSave,onHide:this.handleClose,role:"dialog","aria-labelledby":"saveModal","aria-hidden":"true"},i.a.createElement("div",{role:"document"},i.a.createElement(f.a.Body,null,i.a.createElement("div",null,i.a.createElement("p",null,"Please provide a title for your budget before saving. This is for personal reference only.")),i.a.createElement(v.a,{ref:function(t){return e.saveForm=t},onSubmit:this.handleConfirm,validated:this.state.validated},i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,null,i.a.createElement(v.a.Label,{htmlFor:"userTitleInput"},i.a.createElement("b",null,"Budget Title:")),i.a.createElement(v.a.Control,{type:"input",id:"userTitleInput",name:"userTitleInput",ref:this.budgetTitle,className:"title-field",required:!0}),i.a.createElement(v.a.Control.Feedback,{type:"invalid"},"This field is required."))),i.a.createElement("input",{type:"hidden",name:"redcap_csrf_token",value:""}))),i.a.createElement(f.a.Footer,null,i.a.createElement(p.a,{id:"cancelSaveBtn",variant:"secondary",onClick:this.handleClose},"Close"),i.a.createElement(p.a,{id:"confirmSaveBtn",variant:"primary",type:"submit",onClick:this.handleSubmit},"Save"))))}}]),t}(n.Component),E=a(50),y=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).updateSearchResults=function(){var e=a.state.inputValue.trim();a.props.searchFunction(e),a.setState({lastSearchValue:e})},a.searchKeywords=function(e){e.preventDefault(),a.updateSearchResults()},a.inputKeywords=function(e){e.preventDefault(),a.setState({inputValue:e.target.value},function(){0===a.state.inputValue.trim().length&&0!==a.state.lastSearchValue.length&&a.updateSearchResults()})},a.state={inputValue:"",lastSearchValue:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("form",{className:"form-inline",onSubmit:this.searchKeywords},i.a.createElement("input",{className:"form-control mr-sm-2",type:"search",placeholder:"Search for services","aria-label":"Search",value:this.state.inputValue,onChange:this.inputKeywords}))}}]),t}(n.Component),j=a(48),w=a.n(j),g={urlBase:"http://2019augredcap:8888",urlPathToREDCap:"/redcap",serviceCatalogApi:"/api/?NOAUTH&type=module&prefix=budget_calculator&page=api/service_catalog_api",perServiceAPI:"/api/?NOAUTH&type=module&prefix=budget_calculator&page=api/per_service_api"},k=function(){function e(t,a){Object(r.a)(this,e),this.stateData=t,this.setStateData=a,this.fetchServicesFromApi=this.fetchServicesFromApi.bind(this),this.filterServiceInstancesByKeyword=this.filterServiceInstancesByKeyword.bind(this),this.parseJsonListOfServices=this.parseJsonListOfServices.bind(this),console.log("sd ... bcConfig.urlBase=",g.urlBase)}return Object(s.a)(e,[{key:"fetchServicesFromApi",value:function(){var e=this,t=g.urlBase+g.urlPathToREDCap+g.serviceCatalogApi;fetch(t).then(function(e){return e.json()}).then(function(t){e._jsondata=t,e.parseJsonListOfServices(t),e.fullServiceList?e.setStateData(e.fullServiceList):e.setStateData([])}).catch(function(t){return e.setStateData([])})}},{key:"filterServiceInstancesByKeyword",value:function(e){var t=e.replace(/[\\\/]+/gi,""),a="$filter(**.service_list.*^(service), function($v) {$contains($v.core, /"+t+"/i) or $contains($v.category, /"+t+"/i) or $contains($v.service, /"+t+"/i) or $contains($v.service_description, /"+t+"/i) })";t&&0!==t.trim()||(a="**.service_list.*^(service)");var n=w()(a).evaluate(this._jsondata);n?Array.isArray(n)||(n=[n]):n=[],this.setStateData(n)}},{key:"parseJsonListOfServices",value:function(e){this.fullServiceList=w()("**.service_list.*^(service)").evaluate(e)}}]),e}(),O=a(56),N=a(16),T=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={serviceobj:a.props.serviceobj,servicename:a.props.servicename},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("li",{id:"bc-dropdown-li"},i.a.createElement("a",{className:"dropdown-item",href:"#/",onClick:function(t){return e.props.addBCService(t,e.state.serviceobj)}},this.state.servicename))}}]),t}(n.Component),I=a(47),B=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"my-4"},i.a.createElement(I.a,null,i.a.createElement(I.a.Header,{className:"font-weight-bold"},"Not Found"),i.a.createElement(I.a.Body,null,"No information available.")))}}]),t}(n.Component),V=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).reduceToTree=function(e,t){if(!(t.core&&t.category&&t.service))return e;var a=t.core;e[a]||(e[a]=[]);var n=t.category;e[a][n]||(e[a][n]=[]);var i=t.service;return e[a][n][i]||(e[a][n][i]=[]),e[a][n][i].push(t),e},a.createMenuTree=function(e){var t=Object.values(e).reduce(a.reduceToTree,{});return Object.entries(t).map(function(e){return i.a.createElement("li",{key:e,className:"dropdown-submenu"},i.a.createElement("a",{className:"dropdown-item dropdown-toggle",href:"#/"},e[0]),i.a.createElement("ul",{className:"dropdown-menu"},Object.entries(e[1]).map(function(e){return i.a.createElement("li",{key:e,className:"dropdown-submenu"},i.a.createElement("a",{className:"dropdown-item dropdown-toggle",href:"#/"},e[0]),i.a.createElement("ul",{className:"dropdown-menu"},Object.entries(e[1]).map(function(e){return i.a.createElement(T,{key:e,addBCService:a.props.addBCService,serviceobj:JSON.stringify(e[1]),servicename:e[0]})})))})))})},a.state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Object(N.a)({},this.props.bcServiceData);return i.a.createElement(i.a.Fragment,null,0===Object.entries(e).length?i.a.createElement(B,null):"",this.createMenuTree(e))}}]),t}(n.Component);var D=function(e){var t=Object(n.useState)("Loading Service Catalog ..."),a=Object(E.a)(t,2),l=a[0],c=a[1],r=Object(n.useState)(new k(l,c)),s=Object(E.a)(r,1)[0];return Object(n.useEffect)(function(){s.fetchServicesFromApi()},[]),i.a.createElement(i.a.Fragment,null,i.a.createElement("ul",{className:"dropdown-menu","aria-labelledby":"navbarDropdownMenuLink"},i.a.createElement("li",{className:"bc-dropdown-li-search"},i.a.createElement(y,{searchFunction:s.filterServiceInstancesByKeyword})),i.a.createElement("li",{id:"bc-dropdown-li"},i.a.createElement(O.a.Divider,null)),i.a.createElement(V,{addBCService:e.addBCService,bcServiceData:l})))},R=Object(n.createContext)(42),_=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(R.Consumer,null,function(e){return i.a.createElement(D,{addBCService:function(t,a){return e.addBCService(t,a)}})})}}]),t}(n.Component),F=a(45),x=(a(77),function(){function e(){Object(r.a)(this,e)}return Object(s.a)(e,[{key:"toDollars",value:function(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e)}},{key:"validateTotalCost",value:function(e){return isNaN(e)?0:e}},{key:"findYourRateByProps",value:function(e){return this.findYourRate(e.fundingType,e.federalrate,e.industryrate)}},{key:"findYourRate",value:function(e,t,a){return"federal_rate"===e?t:a}},{key:"isClinical",value:function(e){return parseInt(e.clinical)}},{key:"isNotClinical",value:function(e){return!parseInt(e.clinical)}}]),e}()),H=function(){function e(){Object(r.a)(this,e);var t=new x;this.toDollars=t.toDollars,this.isClinical=t.isClinical,this.isNotClinical=t.isNotClinical,this.columnLookup=[{title:"Clinical Service",dataKey:"service"},{title:"Base Cost",dataKey:"base_cost"},{title:"Your Rate",dataKey:"adjusted_rate"},{title:"Subjects",dataKey:"service_quantity"},{title:"Quantity Type",dataKey:"unit_label"},{title:"Visits",dataKey:"visit_count"},{title:"Cost Per Subject",dataKey:"cost_per_subject"},{title:"Total",dataKey:"subtotal"}],this.clinicalHeaders=[["Clinical Service","Base Cost","Your Rate","Subjects","Quantity Type","Visits","Cost Per Subject","Total"]],this.nonClinicalHeaders=[["Non-Clinical Service","Base Cost","Your Rate","Quantity","Quantity Type","Total"]]}return Object(s.a)(e,[{key:"savePdf",value:function(e){var t=this,a=Object(N.a)({},e),n=this.toDollars(a.clinicalTotals),i=this.toDollars(a.nonclinicalTotals),l=this.toDollars(a.grandTotal),c=a.perService,r=a.bcrows,s=[];Object.values(r).filter(this.isClinical).forEach(function(e){s.push([e.service,t.toDollars(e.industry_rate),t.toDollars(e.yourCost),e.subjectCount,c[e.per_service],e.visitCount.filter(function(e){return e}).length,t.toDollars(e.costPerSubject),t.toDollars(e.totalCost)])}),s.push(["","","","","","","Clinical Total:",n]);var o=[];Object.values(r).filter(this.isNotClinical).forEach(function(e){o.push([e.service,t.toDollars(e.industry_rate),t.toDollars(e.yourCost),e.quantity,c[e.per_service],t.toDollars(e.totalCost)])}),o.push(["","","","","Non-Clinical Total:",i]),console.log("PDF will download .... soon.",a);var u=new F("l","pt");u.autoTable({head:this.clinicalHeaders,body:s,theme:"striped",margin:{top:60}}),u.autoTable({head:this.nonClinicalHeaders,body:o,theme:"striped",margin:{top:60},startY:u.autoTable.previous.finalY}),u.text("Grand Total: "+l,650,u.autoTable.previous.finalY+25),u.save("budget.pdf")}},{key:"testDownloadWorking",value:function(){console.log("PDF will download .... soon.");var e=new F;e.text("Test worked!!",10,10),e.save("a4.pdf")}}]),e}(),U=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleEditBudgetInfoClick=function(){a.state.showInfoCallback()},a.handleDownloadAsPdfClick=function(){(new H).savePdf(a.props.bcstate)},a.state={showInfoCallback:a.props.showInfoCallback},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("nav",{className:"navbar navbar-expand-sm"},i.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNavDropdown"},i.a.createElement("ul",{className:"navbar-nav"},i.a.createElement("li",{className:"nav-item dropdown"},i.a.createElement("a",{className:"nav-link dropdown-toggle",href:"#/",id:"navbarDropdownMenuLink","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Add Service"),i.a.createElement(_,null)),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link btn btn-lg font-weight-bolder",id:"bdgtcalc-nav",href:"#/",onClick:this.handleEditBudgetInfoClick},"Edit Budget Information")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link btn btn-lg font-weight-bolder",id:"bdgtcalc-nav",href:"#/",onClick:this.handleDownloadAsPdfClick},"Download as PDF")))))}}]),t}(n.Component),A=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSaveConfirmSubmission=function(e){e.preventDefault(),a.setState({validated:!0}),a.saveSubmissionForm.checkValidity()&&(a.state.handleBCSubmitCallback({budgetTitle:a.budgetTitle.current.value,username:a.username.current.value,firstName:a.firstName.current.value,lastName:a.lastName.current.value,email:a.email.current.value,irbNumber:a.irbNumber.current.value}),a.setState({showBCSubmit:!1}),a.state.handleBCSubmitHide())},a.handleClose=function(e){e&&e.preventDefault(),a.state.handleBCSubmitHide()},a.state={showBCSubmit:e.showBCSubmit,handleBCSubmitCallback:e.handleBCSubmitCallback,handleBCSubmitHide:e.handleBCSubmitHide,validated:!1},a.budgetTitle=i.a.createRef(),a.username=i.a.createRef(),a.firstName=i.a.createRef(),a.lastName=i.a.createRef(),a.email=i.a.createRef(),a.irbNumber=i.a.createRef(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(f.a,{id:"submitModal",centered:!0,show:this.props.showBCSubmit,onHide:this.handleClose,role:"dialog","aria-labelledby":"submitModal","aria-hidden":"true"},i.a.createElement("div",{role:"document"},i.a.createElement(f.a.Header,{closeButton:!0},i.a.createElement(f.a.Title,null,"Confirm Submission")),i.a.createElement(f.a.Body,null,i.a.createElement("div",null,i.a.createElement("p",null,"We require some additional information before your request can be submitted.")),i.a.createElement(v.a,{id:"submissionForm",ref:function(t){return e.saveSubmissionForm=t},onSubmit:this.handleSaveConfirmSubmission,validated:this.state.validated},i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Label,{htmlFor:"userTitleInputSubmit"},i.a.createElement("b",null,"Budget Title (for future reference):")),i.a.createElement(v.a.Control,{type:"text",ref:this.budgetTitle,id:"userTitleInputSubmit",name:"userTitleInputSubmit",className:"info-field"})),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,{className:"requester-info"},i.a.createElement(v.a.Label,{htmlFor:"username"},i.a.createElement("b",null,"Username")),i.a.createElement(v.a.Control,{type:"text",ref:this.username,id:"username",name:"username",className:"info-field"}))),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,{className:"requester-info"},i.a.createElement(v.a.Label,{htmlFor:"first_name"},i.a.createElement("b",null,"First Name")),i.a.createElement(v.a.Control,{type:"text",ref:this.firstName,id:"first_name",name:"first_name",className:"info-field"}))),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,{className:"requester-info"},i.a.createElement(v.a.Label,{htmlFor:"last_name"},i.a.createElement("b",null,"Last Name")),i.a.createElement(v.a.Control,{type:"text",ref:this.lastName,id:"last_name",name:"last_name",className:"info-field"}))),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,{className:"requester-info"},i.a.createElement(v.a.Label,{htmlFor:"email"},i.a.createElement("b",null,"Email")),i.a.createElement(v.a.Control,{type:"email",ref:this.email,id:"email",name:"email",className:"info-field"}),i.a.createElement(v.a.Control.Feedback,{type:"invalid"},"Any text in this field must be a valid email."))),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,{className:"requester-info"},i.a.createElement(v.a.Label,{htmlFor:"irb"},i.a.createElement("b",null,"IRB Number")),i.a.createElement(v.a.Control,{type:"input",pattern:".+",ref:this.irbNumber,id:"irb",name:"irb",className:"info-field",required:!0}),i.a.createElement(v.a.Control.Feedback,{type:"invalid"},"This field is required."))),i.a.createElement("input",{type:"hidden",name:"redcap_csrf_token",value:""}))),i.a.createElement(f.a.Footer,null,i.a.createElement(p.a,{id:"cancelSaveBtn",variant:"secondary",onClick:this.handleClose},"Back"),i.a.createElement(p.a,{id:"confirmSaveBtn",variant:"primary",type:"submit",onClick:this.handleSaveConfirmSubmission},"Save"))))}}]),t}(n.Component),P=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleClose=function(e){e&&e.preventDefault(),a.state.submitSuccessCallback()},a.state={showSubmitSuccess:e.showSubmitSuccess,submitSuccessCallback:e.submitSuccessCallback},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(f.a,{id:"submitSuccessModal",centered:!0,show:this.props.showSubmitSuccess,onHide:this.handleClose,role:"dialog","aria-labelledby":"submitSuccessModal","aria-hidden":"true"},i.a.createElement("div",{role:"document"},i.a.createElement(f.a.Header,{closeButton:!0},i.a.createElement(f.a.Title,null,"Submitted")),i.a.createElement(f.a.Body,null,"Success!"),i.a.createElement(f.a.Footer,{className:"modal-footer"},i.a.createElement(p.a,{variant:"secondary",onClick:this.handleClose},"Close"))))}}]),t}(n.Component),L=a(17),q=a(18),M=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(L.a,{icon:q.g,size:"lg",color:"red"})}}]),t}(n.Component),W=a(57),K=a(51),Q=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(W.a,{placement:"right",delay:{show:250,hide:400},overlay:i.a.createElement(K.a,{id:"popover-positioned-right"},i.a.createElement(K.a.Content,null,this.props.description))},i.a.createElement(L.a,{icon:q.d,color:"#3E72A8"}))}}]),t}(n.Component),G=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(L.a,{icon:q.f})}}]),t}(n.Component),Y=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(L.a,{icon:q.c})}}]),t}(n.Component),$=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleTrash=function(e){e.persist(),a.props.removeBCService(e,a.props.id)},a.handleSubjectCountChange=function(e){e.persist(),a.props.csUpdateSubjectCountById(e,a.state.id)},a.chooseCheckboxType=function(e,t,n){if(t+e<=n){var l=[],c=!1,r=t+e-1;try{"undefined"!==typeof a.props.bcrows&&"undefined"!==typeof a.props.bcrows[a.state.id]&&"undefined"!==typeof a.props.bcrows[a.state.id].visitCount&&(c=a.props.bcrows[a.state.id].visitCount[r])}catch(s){console.log(s)}return c?l.push(i.a.createElement(v.a.Check,{key:e,className:"visit-checkbox",checked:!0,onChange:function(){return a.props.csVisitChanged(a.state.id,r,!1)}})):l.push(i.a.createElement(v.a.Check,{key:e,className:"visit-checkbox",checked:!1,onChange:function(){return a.props.csVisitChanged(a.state.id,r,!0)}})),l}return" "},a.getCheckboxes=function(e,t){for(var n=[],l=0;l<5;l++)n.push(i.a.createElement("td",{key:l,className:"visit-column"},a.chooseCheckboxType(l,e,t)));return n},a.handleVisitButton=function(e){a.props.handleVisitRowButtonClicked(a.state.id,e)},a.getCheckButton=function(){return a.props.anyVistsNotSelected?i.a.createElement(p.a,{variant:"success",className:"check-row-button",style:{width:"40px"},onClick:function(){a.handleVisitButton(!0)}},i.a.createElement(Y,null)):i.a.createElement(p.a,{variant:"danger",className:"check-row-button",style:{width:"40px"},onClick:function(){a.handleVisitButton(!1)}},i.a.createElement(G,null))},a.state={id:e.id};var n=new x;return a.toDollars=n.toDollars,a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("tr",{className:"service-line-item",onInput:this.handleUpdateTotals},i.a.createElement("td",{style:{borderRightStyle:"hidden"}}," ",i.a.createElement("span",null," ",i.a.createElement("button",{className:"delete btn btn-link",title:"Delete","data-toggle":"tooltip",onClick:this.handleTrash},i.a.createElement(M,null))," ")," "),i.a.createElement("td",{className:"service-title"}," ",i.a.createElement("small",null,this.props.core," > ",this.props.category," ")," ",i.a.createElement("br",null),i.a.createElement("span",null," ",this.props.service," ")," ",i.a.createElement(Q,{description:this.props.description})," "),i.a.createElement("td",{className:"base-cost"},this.toDollars(this.props.industryrate)),i.a.createElement("td",{className:"your-cost"},this.toDollars(this.props.yourCost)),i.a.createElement("td",null,i.a.createElement("input",{className:"qty-count",type:"number",min:"1",value:this.props.subjectCount,onChange:this.handleSubjectCountChange})),i.a.createElement("td",null,this.props.perServiceReadable[this.props.perService]),i.a.createElement("td",{className:"allVisits"},this.getCheckButton()),this.getCheckboxes(this.props.chsVisitIndex,this.props.bcimShowInfoVisitCount),i.a.createElement("td",{className:"line-total-per-patient"},this.toDollars(this.props.costPerSubject)),i.a.createElement("td",{className:"line-total"},this.toDollars(this.props.totalCost)))}}]),t}(n.Component),J=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).displayRows=function(e){if(!(e>0))return i.a.createElement("tr",{id:"clinicalEmpty"},i.a.createElement("td",{colSpan:"14"},"No services added"))};var n=new x;return a.isClinical=n.isClinical,a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(R.Consumer,null,function(t){return i.a.createElement(i.a.Fragment,null,e.displayRows(Object.values(t.bcrows).filter(e.isClinical).length),Object.values(t.bcrows).filter(e.isClinical).map(function(e){return i.a.createElement($,{key:e.key,id:e.id,core:e.core,category:e.category,service:e.service,description:e.service_description,industryrate:e.industry_rate,yourCost:e.yourCost,federalrate:e.federal_rate,clinical:e.clinical,removeBCService:t.removeBCService,fundingType:t.fundingType,subjectCount:e.subjectCount,visitCount:e.visitCount,anyVistsNotSelected:e.anyVistsNotSelected,costPerSubject:e.costPerSubject,totalCost:e.totalCost,perService:e.per_service,bcrows:t.bcrows,csUpdateSubjectCountById:t.csUpdateSubjectCountById,chsVisitIndex:t.chsVisitIndex,bcimShowInfoVisitCount:t.bcimShowInfoVisitCount,csVisitChanged:t.csVisitChanged,handleVisitRowButtonClicked:t.handleVisitRowButtonClicked,perServiceReadable:t.perService})}),i.a.createElement(C,{showInfo:t.bcimShowInfo,showInfoSubjectCount:t.bcimShowInfoSubjectCount,showInfoVisitCount:t.bcimShowInfoVisitCount,infoCallback:t.bcimInfoCallback,hideInfoCallback:t.bcimHandleHideInfo}))})}}]),t}(n.Component),z=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleTrash=function(e){e.persist(),a.props.removeBCService(e,a.props.id)},a.handleQtyCountChange=function(e){e.persist(),a.props.handleQtyCountChange(a.state.id,e.target.value)},a.state={id:e.id};var n=new x;return a.toDollars=n.toDollars,a.validateTotalCost=n.validateTotalCost,a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("tr",{className:"service-line-item",onInput:this.handleUpdateTotals},i.a.createElement("td",{style:{borderRightStyle:"hidden"}}," ",i.a.createElement("span",null," ",i.a.createElement("button",{className:"delete btn btn-link",title:"Delete","data-toggle":"tooltip",onClick:this.handleTrash},i.a.createElement(M,null))," ")," "),i.a.createElement("td",{className:"service-title"}," ",i.a.createElement("small",null,this.props.core," > ",this.props.category," ")," ",i.a.createElement("br",null),i.a.createElement("span",null," ",this.props.service," ")," ",i.a.createElement(Q,{description:this.props.description})," "),i.a.createElement("td",{className:"base-cost"},this.toDollars(this.props.industryrate)),i.a.createElement("td",{className:"your-cost"},this.toDollars(this.props.yourCost),"  "),i.a.createElement("td",null,i.a.createElement("input",{className:"qty-count",type:"number",min:"1",value:this.props.quantity,onChange:this.handleQtyCountChange})),i.a.createElement("td",null,this.props.perServiceReadable[this.props.perService]),i.a.createElement("td",{className:"non_clinical-blank",colSpan:"7"}),i.a.createElement("td",{className:"line-total"},this.toDollars(this.props.totalCost)))}}]),t}(n.Component),X=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).isNonClinical=function(e){return 0===parseInt(e.clinical)},a.displayRows=function(e){if(!(e>0))return i.a.createElement("tr",{id:"clinicalEmpty"},i.a.createElement("td",{colSpan:"14"},"No services added"))},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(R.Consumer,null,function(t){return i.a.createElement(i.a.Fragment,null,e.displayRows(Object.values(t.bcrows).filter(e.isNonClinical).length),Object.values(t.bcrows).filter(e.isNonClinical).map(function(e){return i.a.createElement(z,{key:e.key,id:e.id,core:e.core,category:e.category,service:e.service,description:e.service_description,industryrate:e.industry_rate,federalrate:e.federal_rate,clinical:e.clinical,totalCost:e.totalCost,yourCost:e.yourCost,quantity:e.quantity,perService:e.per_service,removeBCService:t.removeBCService,fundingType:t.fundingType,handleQtyCountChange:t.handleQtyCountChange,addNonclinicalCost:t.addNonclinicalCost,removeNonclinicalCost:t.removeNonclinicalCost,perServiceReadable:t.perService})}))})}}]),t}(n.Component),Z=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(L.a,{icon:q.e})}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(L.a,{icon:q.a})}}]),t}(n.Component),te=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(L.a,{icon:q.b})}}]),t}(n.Component),ae=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getColumButtons=function(e,t){for(var a,n,l,c=[],r=e.length,s=function(r){"select"===e[r]?(a="success",n=!1,l=i.a.createElement(Y,null)):"deselect"===e[r]?(a="danger",n=!1,l=i.a.createElement(G,null)):"disabled"===e[r]&&(a="secondary",n=!0,l=i.a.createElement(Z,null)),c.push(i.a.createElement("td",{key:r},i.a.createElement(p.a,{variant:a,disabled:n,className:"check-column-button",style:{width:"40px"},onClick:function(){t(r,e[r])}},l)))},o=0;o<r;o++)s(o);return c},a.getColumNumbers=function(e,t){for(var a=[],n=0;n<5;n++)a.push(i.a.createElement("td",{key:n},i.a.createElement("b",{className:"visit-header"},e+n<=t?e+n:" ")));return a},a.state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(R.Consumer,null,function(t){return i.a.createElement(i.a.Fragment,null,i.a.createElement("tr",{className:"clinicalHeaders"},i.a.createElement("th",{rowSpan:"3",style:{borderRightStyle:"hidden",width:"3%"}}," "),i.a.createElement("th",{rowSpan:"3",style:{width:"25%"}}," Clinical Service "),i.a.createElement("th",{rowSpan:"3"}," Base Cost "),i.a.createElement("th",{rowSpan:"3"}," Your Cost "),i.a.createElement("th",{rowSpan:"3"}," Subjects "),i.a.createElement("th",{rowSpan:"3"}," Quantity Type "),i.a.createElement("th",{className:"hide-border"},i.a.createElement("div",null,i.a.createElement(p.a,{variant:"primary",disabled:"disabled"===t.chsLeftNavState,onClick:t.cshNavLeft},i.a.createElement(ee,null)))),i.a.createElement("th",{className:"hide-border",colSpan:"4"},"Visits"),i.a.createElement("th",{className:"hide-border"},i.a.createElement("div",null,i.a.createElement(p.a,{variant:"primary",disabled:"disabled"===t.chsRightNavState,onClick:t.cshNavRight},i.a.createElement(te,null)))),i.a.createElement("th",{rowSpan:"3"}," Cost Per Subject "),i.a.createElement("th",{rowSpan:"3",style:{width:"10%"}}," Total Cost ")),i.a.createElement("tr",{className:"visit-header-row"},i.a.createElement("td",{rowSpan:"2"}),e.getColumNumbers(t.chsVisitIndex,t.bcimShowInfoVisitCount)),i.a.createElement("tr",null,e.getColumButtons(t.chsBtnStates,t.cshButtonClicked)))})}}]),t}(n.Component),ne=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={};var n=new x;return a.toDollars=n.toDollars,a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(R.Consumer,null,function(t){return i.a.createElement(i.a.Fragment,null,e.props.grand?e.toDollars(t.grandTotal):"",e.props.clinical?e.toDollars(t.clinicalTotals):"",e.props.nonclinical?e.toDollars(t.nonclinicalTotals):"")})}}]),t}(n.Component),ie=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).submitSuccessCallback=function(){a.setState({showSubmitSuccess:!1})},a.handleBCSubmitHide=function(){return a.setState({showBCSubmit:!1})},a.handleBCSubmitCallback=function(e){console.log("handleBCSubmitCallback ... budgetTitle: "+e.budgetTitle+"; username: "+e.username+"; firstName: "+e.firstName+"; lastName: "+e.lastName+"; email: "+e.email+"; irbNumber: "+e.irbNumber)},a.handleSubmitButtonClick=function(e){a.setState({showBCSubmit:!0})},a.handleSubjectsChange=function(e){e.preventDefault(),a.state.myCallback(a.textInput.current.value),a.state.myHide()},a.handleUpdateTotals=function(e){e.preventDefault(),a.state.myCallback(a.textInput.current.value),a.state.myHide()},a.handleQtyCountChange=function(e){e.preventDefault(),a.state.myCallback(a.textInput.current.value),a.state.myHide()},a.handleUpdateTotals=function(e){e.preventDefault(),a.state.myCallback(a.textInput.current.value),a.state.myHide()},a.state={showSubmitSuccess:!1,showBCSubmit:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("table",{id:"servicesTable",className:"table table-bordered table-striped"},i.a.createElement("tbody",null,i.a.createElement(ae,null)),i.a.createElement("tbody",{id:"clinical"},i.a.createElement(J,null)),i.a.createElement("tbody",null,i.a.createElement("tr",{className:"bg-secondary text-white"},i.a.createElement("td",{colSpan:"13",style:{textAlign:"right",borderRightStyle:"hidden"}},"Clinical Total:"),i.a.createElement("td",{id:"clinicalTotal"},i.a.createElement(ne,{clinical:!0}))),i.a.createElement("tr",{className:"nonClinicalHeaders"},i.a.createElement("th",{style:{borderRightStyle:"hidden",width:"3%"}}," "),i.a.createElement("th",{style:{width:"25%"}},"Non-Clinical Service "),i.a.createElement("th",null,"Base Cost "),i.a.createElement("th",null,"Your Cost "),i.a.createElement("th",null,"Quantity "),i.a.createElement("th",null,"Quantity Type "),i.a.createElement("th",{colSpan:"7"}," "),i.a.createElement("th",null,"Total Cost "))),i.a.createElement("tbody",{id:"non_clinical"},i.a.createElement(X,null)),i.a.createElement("tbody",null,i.a.createElement("tr",{className:"bg-secondary text-white"},i.a.createElement("td",{colSpan:"13",style:{textAlign:"right",borderRightStyle:"hidden"}},"Non-Clinical Total:"),i.a.createElement("td",{id:"non_clinicalTotal"},i.a.createElement(ne,{nonclinical:!0}))),i.a.createElement("tr",{className:"total-row"},i.a.createElement("td",{className:"total-header",colSpan:"13",style:{textAlign:"right",borderRightStyle:"hidden"}},"Grand Total:"),i.a.createElement("td",{className:"total"},i.a.createElement(ne,{grand:!0}))))),i.a.createElement("form",{id:"dirtyCheck",name:"dirtyCheck",onSubmit:this.handleSubmit,className:"dirty"},i.a.createElement("input",{type:"hidden",name:"redcap_csrf_token",value:""})),i.a.createElement("div",{className:"action-button"}),i.a.createElement(A,{showBCSubmit:this.state.showBCSubmit,handleBCSubmitCallback:this.handleBCSubmitCallback,handleBCSubmitHide:this.handleBCSubmitHide}),i.a.createElement(P,{showSubmitSuccess:this.state.showSubmitSuccess,submitSuccessCallback:this.submitSuccessCallback}))}}]),t}(n.Component),le=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleHideInfo=function(){return a.setState({showInfo:!1})},a.showInfoCallback=function(){console.log("edit handled... setting state"),a.setState({showInfo:!0})},a.submitSaveCallback=function(e){console.log("submitSaveCallback ... budget title: "+e.budgetTitle),a.setState({showSave:!0})},a.handleHideSave=function(){return a.setState({showSave:!1})},a.showSubmitCallback=function(){console.log("edit hide submit handled... setting state"),a.setState({showSubmit:!0})},a.infoCallback=function(e){console.log("infoCallback ... Subject Count: "+e.subjectCount+"; Subject Count: "+e.visitCount),a.setState({showInfo:!1,showInfoSubjectCount:e.subjectCount,showInfoVisitCount:e.visitCount})},a.handleHideWelcome=function(){return a.setState({showWelcome:!1})},a.state={showInfo:!1,showSave:!1,showInfoSubjectCount:"",showInfoVisitCount:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{id:"pagecontainer",className:"container-fluid",role:"main"},i.a.createElement("div",{id:"container"},i.a.createElement("div",{id:"pagecontent"},i.a.createElement(b,null),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(C,{showInfo:this.state.showInfo,showInfoSubjectCount:this.state.showInfoSubjectCount,showInfoVisitCount:this.state.showInfoVisitCount,infoCallback:this.infoCallback,hideInfoCallback:this.handleHideInfo}),i.a.createElement(S,{showSave:this.state.showSave,submitSaveCallback:this.submitSaveCallback,handleHideSave:this.handleHideSave}),i.a.createElement(U,{showInfoCallback:this.showInfoCallback,bcstate:this.props.bcstate}),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(ie,null),i.a.createElement("div",{id:"disclaimer"},"This is a work in progress and not representative of the final product. Pricing data is for testing purposes only."))))}}]),t}(n.Component),ce=a(41),re=a(58),se=function(){function e(){Object(r.a)(this,e),this.fetchPerServicesFromApi=this.fetchPerServicesFromApi.bind(this)}return Object(s.a)(e,[{key:"fetchPerServicesFromApi",value:function(e){var t=g.urlBase+g.urlPathToREDCap+g.perServiceAPI;fetch(t).then(function(e){return e.json()}).then(function(t){e(t)}).catch(function(e){return console.log(e)})}}]),e}(),oe=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).psdSetPerService=function(e){a.setState(function(t,a){return{perService:e}})},a.cshNavLeft=function(){a.setState(function(e,t){var a=e.chsVisitIndex;return{chsVisitIndex:a-=5}},a.csHeaderUpdate)},a.cshNavRight=function(){a.setState(function(e,t){var a=e.chsVisitIndex;return{chsVisitIndex:a+=5}},a.csHeaderUpdate)},a.cshButtonClicked=function(e,t){var n=!1;"select"===t&&(n=!0),a.setState(function(t,i){var l=t.chsVisitIndex+e-1,c=Object(N.a)({},t.bcrows);return Object.values(c).filter(a.isClinical).forEach(function(e){c[e.id].visitCount[l]=n,c[e.id].anyVistsNotSelected=e.visitCount.filter(function(e){return!e}).length>0}),{bcrows:c}},function(){a.csHeaderUpdate()})},a.cshSubjectsAndVisitsNeeded=function(e){a.setState({bcInfoModalUsedOnce:!0,bcimShowInfo:!0,bcInfoModalNeeded:e})},a.bcimInfoCallback=function(e){a.setState({bcimShowInfo:!1,bcimShowInfoSubjectCount:e.subjectCount,bcimShowInfoVisitCount:e.visitCount},function(){a.bcimUpdateAllSubjectCountsAndVisitCounts(e.subjectCount,e.visitCount)})},a.bcimHandleHideInfo=function(){return a.setState({bcimShowInfo:!1})},a.bcimUpdateAllSubjectCountsAndVisitCounts=function(e,t){var n=Object(N.a)({},a.state.bcrows);Object.values(n).filter(a.isClinical).forEach(function(a){n[a.id].subjectCount=e;for(var i=[],l=0;l<t;l++)i.push(!1);n[a.id].visitCount=i}),a.setState({bcrows:n}),a.csHeaderUpdate()},a.cshUpdateCheckButtons=function(e){for(var t=[],n=Object.values(e.bcrows).filter(a.isClinical),i=0;i<5;i++){e.bcimShowInfoVisitCount>=e.chsVisitIndex+i&&n.length>0?function(){var a=e.chsVisitIndex+i-1,l="deselect";Object.values(n).filter(function(e){return!e.visitCount[a]}).length>0&&(l="select"),t.push(l)}():t.push("disabled")}return t},a.csHeaderUpdate=function(){a.setState(function(e,t){var n="disabled",i="disabled";return e.chsVisitIndex>5&&(n="active"),e.bcimShowInfoVisitCount-e.chsVisitIndex>=5&&(i="active"),{chsLeftNavState:n,chsRightNavState:i,chsBtnStates:a.cshUpdateCheckButtons(e)}},function(){a.cshUpdateAllClinicalTotals()})},a.csUpdateSubjectCountById=function(e,t){var n=Object(N.a)({},a.state.bcrows);n[t].subjectCount=e.target.value,a.setState({bcrows:n},a.csUpdateClinicalTotals(t))},a.csUpdateColumnCheckButtonState=function(e){a.setState(function(t,a){console.log("pts-69:csUpdateColumnCheckButtonState->visitIndex",e),console.log("pts-69:csUpdateColumnCheckButtonState->state",t);for(var n=Object.values(t.bcrows),i=!1,l=0;l<n.length;l++)if(!n[l].visitCount[e]){i=!0;break}var c=e%5;if(i!==t.chsBtnStates[c]){var r=Object(re.a)(t.chsBtnStates);return r[c]=i?"select":"deselect",{chsBtnStates:r}}return{}})},a.csUpdateRowCheckButtonState=function(e){a.setState(function(t,a){for(var n=t.bcrows[e].visitCount,i=!1,l=0;l<n.length;l++)if(!n[l]){i=!0;break}if(i!==t.bcrows[e].anyVistsNotSelected){var c=Object(N.a)({},t.bcrows);return c[e].anyVistsNotSelected=i,{bcrows:c}}return{}},function(){a.csUpdateClinicalTotals(e)})},a.csVisitChanged=function(e,t,n){a.setState(function(a,i){console.log("pts-69:csVisitChange->state",a),console.log("pts-69:csVisitChange->visitIndex",t),console.log("pts-69:csVisitChange->value",n);var l=Object(N.a)({},a.bcrows);return l[e].visitCount[t]=n,{bcrows:l}},function(){a.csUpdateColumnCheckButtonState(t),a.csUpdateRowCheckButtonState(e)})},a.handleVisitRowButtonClicked=function(e,t){a.setState(function(a,n){for(var i=a.bcrows[e].visitCount.length,l=Object(N.a)({},a.bcrows),c=0;c<i;c++)a.bcrows[e].visitCount[c]!==t&&(l[e].visitCount[c]=t);return{bcrows:l}},function(){a.csHeaderUpdate(),a.csUpdateRowCheckButtonState(e)})},a.csSetRowTotal=function(e,t){var a=t[e].visitCount.filter(function(e){return e}).length,n=t[e].costPerSubject*a*t[e].subjectCount;return t[e].totalCost=n,t},a.csTotalPerSubject=function(e,t,a){var n,i=e.bcrows[t];return n=("federal_rate"===e.fundingType?i.federal_rate:i.industry_rate)*i.visitCount.filter(function(e){return e}).length,a[t].costPerSubject=n,a},a.csCalculateClinicalTotals=function(e){return Object.values(e).filter(a.isClinical).reduce(function(e,t){return e+t.totalCost},0)},a.csUpdateClinicalTotals=function(e){a.setState(function(t,n){var i=Object(N.a)({},t.bcrows);return i=a.csTotalPerSubject(t,e,i),{bcrows:i=a.csSetRowTotal(e,i),clinicalTotals:a.csCalculateClinicalTotals(i)}},a.calculateGrandTotals)},a.cshUpdateAllClinicalTotals=function(){a.setState(function(e,t){for(var n=Object(N.a)({},e.bcrows),i=Object.values(n).filter(a.isClinical),l=0;l<i.length;l++)n=a.csTotalPerSubject(e,i[l].key,n),n=a.csSetRowTotal(i[l].key,n);return{bcrows:n,clinicalTotals:a.csCalculateClinicalTotals(n)}},a.calculateGrandTotals)},a.ncsCalculateNonclinicalTotals=function(){var e=function(e,t){return e+t.totalCost};a.setState(function(t,n){return{nonclinicalTotals:Object.values(t.bcrows).filter(a.isNotClinical).reduce(e,0)}},a.calculateGrandTotals)},a.calculateGrandTotals=function(){a.setState(function(e,t){return{grandTotal:e.nonclinicalTotals+e.clinicalTotals}})},a.setFundingType=function(e,t){a.setState({fundingType:t})},a.handleQtyCountChange=function(e,t){var n;a.setState(function(i,l){var c=Object(N.a)({},i.bcrows);return n=a.isNotClinical(c[e]),c[e].quantity=t,n&&(c[e].totalCost=c[e].yourCost*c[e].quantity),{bcrows:c}},function(){n&&a.ncsCalculateNonclinicalTotals()})},a.removeBCService=function(e,t){var n;a.setState(function(e,i){var l=Object(N.a)({},e.bcrows);return n=a.isNotClinical(l[t]),delete l[t],{bcrows:l}},function(){n?a.ncsCalculateNonclinicalTotals():(a.cshUpdateAllClinicalTotals(),a.csHeaderUpdate())})},a.addServiceUpdates=function(e,t,n){e?a.cshSubjectsAndVisitsNeeded(n):"1"===t.clinical&&a.csHeaderUpdate()},a.addBCService=function(e,t){e.persist(),e.preventDefault();var n=new x,i="_"+Math.random().toString(36).substr(2,9),l=JSON.parse(t)[0],c=!a.state.bcInfoModalUsedOnce&&parseInt(l.clinical);a.setState(function(e,t){l.id=i,l.key=i,l.subjectCount=e.bcimShowInfoSubjectCount,l.visitCount=[];for(var a=0;a<e.bcimShowInfoVisitCount;a++)l.visitCount.push(!1);return l.anyVistsNotSelected=!0,l.costPerSubject=0,l.totalCost=0,l.yourCost=n.findYourRate(e.fundingType,l.federal_rate,l.industry_rate),l.quantity=1,l.totalCost=l.yourCost*l.quantity,{bcrows:Object(N.a)({},e.bcrows,Object(ce.a)({},i,l))}},function(){a.addServiceUpdates(c,l,i),a.isNotClinical(l)&&a.ncsCalculateNonclinicalTotals()})},a.state={bcInfoModalUsedOnce:!1,bcimShowInfo:!1,bcimShowSave:!1,bcimShowInfoSubjectCount:0,bcimShowInfoVisitCount:0,bcInfoModalNeeded:!1,fundingType:"",bcrows:{},nonclinicalTotals:0,clinicalTotals:0,grandTotal:0,chsLeftNavState:"disabled",chsRightNavState:"disabled",chsBtnStates:["disabled","disabled","disabled","disabled","disabled"],chsVisitIndex:1,perService:{}},a.perServiceData=new se,a.perServiceData.fetchPerServicesFromApi(a.psdSetPerService);var n=new x;return a.isClinical=n.isClinical,a.isNotClinical=n.isNotClinical,a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(R.Provider,{value:{bcstate:this.state,bcrows:this.state.bcrows,fundingType:this.state.fundingType,nonclinicalTotals:this.state.nonclinicalTotals,clinicalTotals:this.state.clinicalTotals,grandTotal:this.state.grandTotal,perService:this.state.perService,addBCService:this.addBCService,removeBCService:this.removeBCService,setFundingType:this.setFundingType,chsLeftNavState:this.state.chsLeftNavState,chsRightNavState:this.state.chsRightNavState,chsBtnStates:this.state.chsBtnStates,chsVisitIndex:this.state.chsVisitIndex,chsVisitAllSelected:this.state.chsVisitAllSelected,cshNavLeft:this.cshNavLeft,cshNavRight:this.cshNavRight,cshButtonClicked:this.cshButtonClicked,bcimShowInfo:this.state.bcimShowInfo,bcimShowInfoSubjectCount:this.state.bcimShowInfoSubjectCount,bcimShowInfoVisitCount:this.state.bcimShowInfoVisitCount,bcimInfoCallback:this.bcimInfoCallback,bcimHandleHideInfo:this.bcimHandleHideInfo,csUpdateSubjectCountById:this.csUpdateSubjectCountById,csVisitChanged:this.csVisitChanged,handleVisitRowButtonClicked:this.handleVisitRowButtonClicked,handleQtyCountChange:this.handleQtyCountChange}},this.props.children)}}]),t}(n.Component),ue=a(28),de=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCheck=function(e){return a.setState({buttonActive:e.target.checked})},a.handleSubmit=function(e){e.preventDefault(),a.state.setFundingType(e,a.selection.current.value),a.state.welcomeCallback(a.selection.current.value),a.setState({showWelcome:!1})},a.state={showWelcome:e.showWelcome,welcomeCallback:e.welcomeCallback,buttonActive:!1,setFundingType:e.setFundingType},a.selection=i.a.createRef(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement(f.a,{id:"welcomeModal",centered:!0,backdrop:"static",show:this.props.showWelcome,"aria-labelledby":"welcomeModal","aria-hidden":"true"},i.a.createElement("div",{role:"document"},i.a.createElement(v.a,{id:"welcomeForm",onSubmit:this.handleSubmit},i.a.createElement(f.a.Body,null,i.a.createElement("p",null,"Thank you for using the Budget Calculator! Please provide the following information to get started."),i.a.createElement(v.a.Row,null,i.a.createElement(v.a.Group,{className:"initial-info"},i.a.createElement(v.a.Label,{htmlFor:"fundingType"},i.a.createElement("b",null,"Funding Type:")),i.a.createElement(v.a.Control,{className:"info-field",as:"select",id:"fundingType",name:"fundingType",ref:this.selection,required:!0},i.a.createElement("option",{value:""},"---Select---"),i.a.createElement("option",{value:"industry_rate"},"Industry Rate"),i.a.createElement("option",{value:"federal_rate"},"Federal Rate")))),i.a.createElement(v.a.Row,{className:"welcomeOnly"},i.a.createElement(v.a.Check,null,i.a.createElement(ue.a.Input,{type:"checkbox",id:"termsCheckbox",name:"termsCheckbox",onChange:this.handleCheck}),i.a.createElement(v.a.Label,{htmlFor:"termsCheckbox"},"I understand that this tool is intended for budgeting purposes only and rates are subject to change."))),i.a.createElement("input",{type:"hidden",name:"redcap_csrf_token",value:""})),i.a.createElement(f.a.Footer,null,i.a.createElement(p.a,{variant:"primary",disabled:!this.state.buttonActive,type:"submit"},"Create New Budget")))))}}]),t}(n.Component),me=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).welcomeCallback=function(e){a.setState({showWelcome:!1})},a.state={showWelcome:!0},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(oe,null,i.a.createElement(R.Consumer,null,function(t){return i.a.createElement(i.a.Fragment,null,i.a.createElement(le,{bcstate:t.bcstate}),i.a.createElement(de,{showWelcome:e.state.showWelcome,welcomeCallback:e.welcomeCallback,hideWelcome:e.handleHideWelcome,setFundingType:t.setFundingType}))}))}}]),t}(n.Component);a(81),a(82);var he=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(me,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(he,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[59,1,2]]]);
//# sourceMappingURL=main.ce34f51e.chunk.js.map